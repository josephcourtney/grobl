- [x] Add regression test ensuring the root CLI forwards scan options when invoked without an explicit command.
- [x] Update the CLI default-command fallback to correctly route option flags to the scan command.
- [x] Remove the resolved CLI issue entry and record the fix in the changelog with a patch version bump.
- [x] Increment the project patch version to reflect the CLI fix.
- [x] Add regression tests ensuring text detection reuses prefetched content and avoids redundant reads.
- [x] Implement detector-prefetch plumbing so text files are read only once during scans.
- [x] Document the fix, remove the resolved issue entry, and bump the patch version.
- [x] Add regression tests ensuring filesystem root anchors are treated as valid scan roots and passed through the CLI without fallback.
- [x] Allow filesystem root anchors to be used directly as scan roots instead of reverting to the current working directory.
- [x] Add regression tests ensuring BrokenPipe handling flows through a shared helper for both the root entry point and the scan command.
- [x] Introduce a shared BrokenPipe exit helper and update CLI code to delegate to it.
- [x] Remove the resolved BrokenPipe handling issue, update the changelog, and bump the patch version.
- [x] Add regression tests covering XML/Markdown payload escaping for metadata and file contents.
- [x] Implement escaping helpers and apply them to payload builders to harden XML/Markdown output.
- [x] Record the payload escaping fix (TODO/ISSUES/changelog) and bump the patch version.
- [x] Add regression tests covering the shared directory tree annotation helper for metadata and markdown outputs.
- [x] Refactor the directory tree renderer to use a shared annotation helper and remove duplication.
- [x] Record the directory renderer refactor (TODO/ISSUES/changelog), remove the resolved issue, and bump the patch version.
- [x] Add regression tests ensuring `traverse_dir` accepts a `TraverseConfig` dataclass while preserving filtering behaviour.
- [x] Refactor traversal code to use `TraverseConfig` instead of overloaded tuples and update all call sites.
- [x] Record the traversal refactor by updating the changelog, removing the resolved issue entry, and bumping the patch version.
- [x] Add regression tests ensuring `ScanExecutor` delegates payload emission and summary shaping to dedicated helpers.
- [x] Refactor `ScanExecutor` to use payload strategies and a summary helper instead of inline branching.
- [x] Add regression tests ensuring the markdown snapshot schema and header helper cover layout/schema separation cases.
- [x] Refactor the markdown payload builder to introduce a schema layer and centralize BEGIN_FILE header formatting.
- [x] Record the markdown builder refactor (TODO/ISSUES/changelog), remove the resolved issue entry, and bump the patch version.
- [x] Add unit tests exercising centralized summary totals and inclusion semantics for builders, renderers, and summaries.
- [x] Refactor directory totals/inclusion tracking into a shared helper and update consumers to query it.
- [x] Remove the resolved totals/inclusion issue, record the change in the changelog, and bump the patch version.
